<!DOCTYPE html>
<html>
    <head>
        <meta charset="gbk" />
        <title>brix demo - tables + pagination + 局部刷新</title>
        <style type="text/css">
            body, form, h1, h2, h3, h4, p, img, ul, li, ol, dl, dt, dd, a, span, input, tr, th, td{margin:0;padding:0;}
		    body {font:normal 12px/1.5 "Arial","宋体","Simsun","Tahoma",sans-serif;}
		    li {list-style:none;}
		    img {border:0 none;vertical-align:top;}
		    table {border-collapse:collapse;border-spacing:0;}
            .clear-fix:after {display:block;visibility:hidden;font-size:0;line-height:0;clear:both;content:"";}  
            .clear-fix {zoom:1;}
		    a {color:#000;text-decoration:none;}
		    a:hover {color:#f44;text-decoration:underline;}
            
        </style>
        <link rel='stylesheet' href="http://a.tbcdn.cn/apps/e/brix/brix-min.css">
        <script src="https://s.tbcdn.cn/s/kissy/1.2.0/kissy.js"></script>
        <script type="text/javascript" src="http://a.tbcdn.cn/apps/e/brix/1.0/brix.js" bx-config="{autoConfig: true}"></script>
    </head>
    <body>
        <div id="container" class="container">
        </div>
        <hr />
        <div id="container2" class="container">
        </div>
        <hr />
        <div id="container3" class="container">
        </div>
        <hr />
        <div id="container5">
	    </div>
	    <button id="btn5" class="btn btn-taobao btn-size30">
	    	rename to LiMu
	    </button>
       
        

        <script>
            var S = KISSY, D = S.DOM, E = S.Event;
            var list_data = {
                versions: [
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1349020800,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1349107200,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1349193600,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1349280000,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1349366400,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1349452800,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1349539200,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1349625600,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1349712000,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1349798400,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1349884800,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1349971200,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1350057600,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1350144000,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1350230400,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1350316800,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1350403200,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1350489600,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1350576000,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1350662400,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1350748800,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1350835200,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1350921600,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1351008000,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1351094400,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1351180800,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1351267200,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1351353600,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1351440000,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1351526400,"avg_run_time":0},
                    {"login_user_count":0,"uv":0,"reg_user_count":0,"day":1351612800,"avg_run_time":0}
                ]
            };
            var list_data1 = {
                versions: [
                    {"login_user_count":1,"uv":1,"reg_user_count":0,"day":1351094400,"avg_run_time":0},
                    {"login_user_count":1,"uv":1,"reg_user_count":4,"day":1351180800,"avg_run_time":0},
                    {"login_user_count":1,"uv":1,"reg_user_count":4,"day":1351267200,"avg_run_time":0},
                    {"login_user_count":1,"uv":1,"reg_user_count":4,"day":1351612800,"avg_run_time":0}
                ]
            };
            var list_data2 = {
                versions: [
                    {"login_user_count":2,"uv":2,"reg_user_count":0,"day":1349020800,"avg_run_time":0},
                    {"login_user_count":2,"uv":2,"reg_user_count":0,"day":1351440000,"avg_run_time":0},
                    {"login_user_count":2,"uv":2,"reg_user_count":0,"day":1351526400,"avg_run_time":0},
                    {"login_user_count":2,"uv":2,"reg_user_count":0,"day":1351612800,"avg_run_time":0}
                ]
            };
            var list_data3 = {
                versions: [
                    {"login_user_count":3,"uv":3,"reg_user_count":0,"day":1349020800,"avg_run_time":0},
                    {"login_user_count":3,"uv":3,"reg_user_count":0,"day":1351440000,"avg_run_time":0},
                    {"login_user_count":3,"uv":3,"reg_user_count":0,"day":1351526400,"avg_run_time":0},
                    {"login_user_count":3,"uv":3,"reg_user_count":0,"day":1351612800,"avg_run_time":0}
                ]
            };
            var list_data4 = {
                versions: [
                    {"login_user_count":4,"uv":4,"reg_user_count":0,"day":1349020800,"avg_run_time":0},
                    {"login_user_count":4,"uv":4,"reg_user_count":0,"day":1351440000,"avg_run_time":0},
                    {"login_user_count":4,"uv":4,"reg_user_count":0,"day":1351526400,"avg_run_time":0},
                    {"login_user_count":4,"uv":4,"reg_user_count":0,"day":1351612800,"avg_run_time":0}
                ]
            };
            var list_arr = [list_data1, list_data2, list_data3, list_data4];
            console.log(list_arr);

            KISSY.use('brix/gallery/tables/, brix/gallery/pagination/, brix/gallery/tables/tables.css, brix/gallery/pagination/pagination.css, brix/core/chunk', function(S, Tables, Pagination) {

                var tables = new Tables({
                    container: '#container',
                    tmpl: '#tmpl_list1',
                    data: list_data1
                });

                //console.log(list_data);
                var pagination = new Pagination({
                    tmpl: '.pagination',
                    count: list_data.versions.length,
                    size: 10,
                    step: 5,
                    goTo: false
                });

                pagination.on('gotoPage', function(ev){
                    //console.log(ev);
                    //console.log(ev.index);
                    var flag_arr = ev.index - 1;
                    //var new_data = 'list_data' + ev.index;
                    //eval('new_data=list_data'+ev.index);
                    //console.log(new_data);
                    //console.log(list_arr);
                    tables.setChunkData('versions', list_arr[flag_arr].versions)
                });

            });
           





            //demo2
            var data = {
		    	name:'ZuoMo'
		    };
            var data2 = {
		    	name:'LiMu'
		    };

		    KISSY.use('brix/gallery/tables/',function(S, Tables){
                
                var tables = new Tables({
                    container:'#container5',
                    tmpl:'#tmpl_tables',
                    data: data
                });

		    	S.one('#btn5').on('click',function(){
		    		//模板局部刷新
		    		//tables.setChunkData('name', data2.name);
		    		tables.setChunkData('name', 'LiMu');
		    	});
		    });


	    </script>
        <script type="text/template" id="tmpl_list1">
            <table cellspacing="0" cellpadding="0" width="100%" class="table tb-gl-sty" id="J_tj_second" bx-name="tables" bx-datakey="versions">
            <thead>
                <tr>
	    			<td bx-tmpl="tables" bx-datakey="name">日期</td>
                    <td>日UV</td>
                    <td>总登录用户</td>
                    <td>新注册用户</td>
                    <td class="last-td">平均使用时长(秒)</td>
                </tr>
            </thead>
            <tbody bx-tmpl="tables" bx-datakey="versions">
                <!--bx-tmpl="tables" bx-datakey="versions"-->
                {{#versions}}
                <tr>
                    <td>{{day}}</td>
                    <td>{{login_user_count}}</td>
                    <td>{{uv}}</td>
                    <td>{{reg_user_count}}</td>
                    <td class="last-td">{{avg_run_time}}</td>
                </tr>
                {{/versions}}
                <!--bx-tmpl="tables"-->
            </tbody>
            <tfoot>
                <tr>
                    <td class="td-ft-sty last-td center" colspan="5">
                        <div bx-name="pagination" class="pagination">
                        </div>
                    </td>
                </tr>
            </tfoot>
        </table>
        </script>
        <script type="text/template" id="tmpl_tables">
		    <div bx-name="tables">
			    <span>Hello 
	    			<span bx-tmpl="tables" bx-datakey="name"><!--bx-tmpl="tables" bx-datakey="name"-->{{name}}<!--bx-tmpl="tables"--></span>
			    </span>
		    </div>
	    </script>
    </body>
</html>
